name: ConsolidaÃ§Ã£o Mensal de Dados

# 1. QUANDO RODAR (GATILHO)
on:
  schedule:
    # Roda no primeiro dia de cada mÃªs, Ã  00:00 (meia-noite) UTC.
    # Isso garante que ele pegue os dados do mÃªs ANTERIOR completo.
    - cron: '0 0 1 * *' 
  
  # Gatilho manual: permite que vocÃª teste ou dispare o backup a qualquer momento
  workflow_dispatch:

# 2. OS TRABALHOS (JOB)
jobs:
  run_monthly_consolidation:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¦ Checkout CÃ³digo
        uses: actions/checkout@v4

      # ğŸ ConfiguraÃ§Ã£o do ambiente Python e InstalaÃ§Ã£o de dependÃªncias
      - name: Set up Python e Instalar DependÃªncias
        uses: actions/setup-python@v5
        with:
          python-version: '3.x' 
      
      - name: Instalar gspread e Outras Bibliotecas
        run: pip install -r requirements.txt

      # ğŸ” Configura o arquivo de credenciais do Google Service Account
      - name: Criar Arquivo de Credenciais
        run: ${{ secrets.GOOGLE_CREDENTIALS }} > credenciais.json
        # Importante: O nome do arquivo 'credenciais.json' DEVE bater com o 
        # 'filename' usado no seu script Python (que vocÃª usou como 'caminho/do/seu/credenciais.json')
        # Para simplificar, vou assumir que vocÃª mudarÃ¡ seu script para:
        # gc = gspread.service_account(filename='credenciais.json')

      # ğŸš€ EXECUÃ‡ÃƒO DO SCRIPT DE CONSOLIDAÃ‡ÃƒO MENSAL
      - name: Executar ConsolidaÃ§Ã£o Mensal
        run: python consolidacao_mensal.py
